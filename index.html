<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>具体⇄抽象トレーニングアプリ</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== リセット & 基本設定 ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-blue: #4A90E2;
            --primary-orange: #F5A623;
            --easy-green: #7ED321;
            --hard-yellow: #F8E71C;
            --expert-red: #D0021B;
            --concrete-blue: #3498db;
            --abstract-red: #e74c3c;
            --bg-light: #f8f9fa;
            --text-dark: #333;
            --text-light: #666;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        /* ===== ヘッダー ===== */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            padding: 0.5rem 1.5rem;
            border: none;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        /* ===== メインコンテンツ ===== */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.5s;
        }
        
        .screen.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h1, h2, h3 {
            margin-bottom: 1rem;
            color: var(--text-dark);
        }
        
        h1 {
            font-size: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h2 {
            font-size: 1.5rem;
            border-left: 4px solid var(--primary-blue);
            padding-left: 1rem;
            margin-top: 2rem;
        }
        
        h3 {
            font-size: 1.2rem;
            color: var(--primary-orange);
        }
        
        /* ===== ホーム画面 ===== */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
            border-radius: 15px;
            color: white;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
        }
        
        .feature-card i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .feature-card h3 {
            color: white;
            margin-bottom: 1rem;
        }
        
        /* ===== ゲーム画面 ===== */
        .game-setup {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        input[type="number"] {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Noto Sans JP', sans-serif;
            transition: border-color 0.3s;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-blue);
        }
        
        .difficulty-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .difficulty-btn {
            flex: 1;
            min-width: 120px;
            padding: 1rem;
            border: 3px solid transparent;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .difficulty-btn.easy {
            background: var(--easy-green);
            color: white;
        }
        
        .difficulty-btn.hard {
            background: var(--hard-yellow);
            color: var(--text-dark);
        }
        
        .difficulty-btn.expert {
            background: var(--expert-red);
            color: white;
        }
        
        .difficulty-btn:hover, .difficulty-btn.selected {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: var(--text-dark);
        }
        
        .btn-primary {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
            margin-top: 1rem;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            padding: 0.8rem 1.5rem;
            background: white;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .btn-secondary:hover {
            background: var(--primary-blue);
            color: white;
        }
        
        /* ===== ゲームプレイ画面 ===== */
        .game-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .word-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 3rem;
            border-radius: 20px;
            margin: 2rem 0;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }
        
        .words {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }
        
        .word {
            background: white;
            color: var(--primary-blue);
            padding: 1.5rem 2.5rem;
            border-radius: 15px;
            font-size: 2rem;
            font-weight: 700;
            box-shadow: var(--shadow);
        }
        
        .answer-section {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }
        
        .answer-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1rem;
            font-family: 'Noto Sans JP', sans-serif;
            margin-bottom: 1rem;
        }
        
        .rating-section {
            text-align: center;
            margin: 2rem 0;
        }
        
        .stars {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .star {
            font-size: 2.5rem;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .star:hover, .star.active {
            color: #ffd700;
            transform: scale(1.2);
        }
        
        .scoreboard {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }
        
        .player-score {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            box-shadow: var(--shadow);
        }
        
        .player-name {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .player-points {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
        }
        
        /* ===== ブレインストーミング画面 ===== */
        .brainstorm-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .theme-input {
            flex: 1;
            min-width: 200px;
            padding: 0.8rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .btn-add {
            padding: 0.8rem 1.5rem;
            background: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .btn-save, .btn-load, .btn-clear {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Noto Sans JP', sans-serif;
        }
        
        .btn-save {
            background: var(--easy-green);
            color: white;
        }
        
        .btn-load {
            background: var(--primary-orange);
            color: white;
        }
        
        .btn-clear {
            background: var(--expert-red);
            color: white;
        }
        
        .canvas-area {
            background: white;
            min-height: 500px;
            border: 2px dashed #ddd;
            border-radius: 15px;
            padding: 1rem;
            position: relative;
        }
        
        .sticky-note {
            position: absolute;
            width: 200px;
            min-height: 150px;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            cursor: move;
            transition: transform 0.2s;
        }
        
        .sticky-note:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
        }
        
        .sticky-note.concrete {
            background: linear-gradient(135deg, #a8e6cf 0%, #3498db 100%);
        }
        
        .sticky-note.abstract {
            background: linear-gradient(135deg, #ffd3b6 0%, #e74c3c 100%);
        }
        
        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .note-tag {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            background: white;
        }
        
        .note-delete {
            background: transparent;
            border: none;
            color: var(--expert-red);
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .note-content {
            background: white;
            padding: 0.8rem;
            border-radius: 8px;
            min-height: 80px;
            word-wrap: break-word;
        }
        
        /* ===== 解説画面 ===== */
        .explanation-content {
            line-height: 1.8;
        }
        
        .explanation-content p {
            margin-bottom: 1rem;
            color: var(--text-light);
        }
        
        .example-box {
            background: var(--bg-light);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid var(--primary-orange);
        }
        
        .example-box h4 {
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }
        
        .hierarchy-diagram {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(to right, var(--abstract-red), var(--concrete-blue));
            border-radius: 15px;
            color: white;
            margin: 1.5rem 0;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .training-list {
            list-style: none;
            padding-left: 0;
        }
        
        .training-list li {
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: var(--bg-light);
            border-radius: 10px;
            border-left: 4px solid var(--primary-blue);
        }
        
        .training-list li strong {
            color: var(--primary-orange);
        }
        
        .checklist {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }
        
        .checklist h3 {
            color: white;
            margin-bottom: 1rem;
        }
        
        .checklist ul {
            list-style: none;
            padding-left: 0;
        }
        
        .checklist li {
            padding: 0.8rem;
            margin-bottom: 0.5rem;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
        }
        
        .checklist li i {
            margin-right: 0.5rem;
        }
        
        /* ===== ハイスコア表示 ===== */
        .highscore-list {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }
        
        .highscore-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            box-shadow: var(--shadow);
        }
        
        .rank {
            font-size: 1.5rem;
            font-weight: 700;
            width: 50px;
            text-align: center;
        }
        
        .rank.gold { color: #FFD700; }
        .rank.silver { color: #C0C0C0; }
        .rank.bronze { color: #CD7F32; }
        
        /* ===== レスポンシブデザイン ===== */
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-links {
                width: 100%;
                justify-content: center;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .screen {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            h2 {
                font-size: 1.2rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .word {
                font-size: 1.5rem;
                padding: 1rem 1.5rem;
            }
            
            .difficulty-buttons {
                flex-direction: column;
            }
            
            .brainstorm-controls {
                flex-direction: column;
            }
            
            .sticky-note {
                width: 150px;
                min-height: 120px;
            }
        }
        
        /* ===== ユーティリティ ===== */
        .text-center {
            text-align: center;
        }
        
        .mt-2 {
            margin-top: 2rem;
        }
        
        .mb-2 {
            margin-bottom: 2rem;
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-brain"></i> 具体⇄抽象トレーニング
            </div>
            <div class="nav-links">
                <button class="nav-btn" onclick="showScreen('home')"><i class="fas fa-home"></i> ホーム</button>
                <button class="nav-btn" onclick="showScreen('game-setup')"><i class="fas fa-gamepad"></i> ゲーム</button>
                <button class="nav-btn" onclick="showScreen('brainstorm')"><i class="fas fa-lightbulb"></i> ブレスト</button>
                <button class="nav-btn" onclick="showScreen('explanation')"><i class="fas fa-book"></i> 解説</button>
            </div>
        </nav>
    </header>

    <div class="container">
        <!-- ホーム画面 -->
        <div id="home" class="screen active">
            <h1>具体⇄抽象トレーニングアプリ</h1>
            <p class="text-center" style="margin: 1rem 0; color: var(--text-light); font-size: 1.1rem;">
                楽しく学んで、会話力・説明力・問題解決力をアップ！
            </p>
            
            <div class="feature-grid">
                <div class="feature-card" onclick="showScreen('game-setup')">
                    <i class="fas fa-gamepad"></i>
                    <h3>具体抽象化ゲーム</h3>
                    <p>2〜20人で楽しめる！単語の共通点を見つけて抽象化するゲームです。Easy、Hard、Expertの3つの難易度から選べます。</p>
                </div>
                
                <div class="feature-card" onclick="showScreen('brainstorm')">
                    <i class="fas fa-lightbulb"></i>
                    <h3>ブレインストーミング</h3>
                    <p>アイデアを具体と抽象に分けて整理！付箋を自由に配置して思考を可視化できます。</p>
                </div>
                
                <div class="feature-card" onclick="showScreen('explanation')">
                    <i class="fas fa-book"></i>
                    <h3>解説</h3>
                    <p>具体⇄抽象の重要性、使い方、トレーニング方法を詳しく解説。今すぐ実践できるチェックリスト付き！</p>
                </div>
            </div>
            
            <div class="highscore-list mt-2">
                <h2><i class="fas fa-trophy"></i> ハイスコアランキング</h2>
                <div id="highscore-display"></div>
            </div>
        </div>

        <!-- ゲーム設定画面 -->
        <div id="game-setup" class="screen">
            <h1><i class="fas fa-gamepad"></i> ゲーム設定</h1>
            
            <div class="game-setup">
                <div class="form-group">
                    <label for="player-count"><i class="fas fa-users"></i> 参加人数（2〜20人）</label>
                    <input type="number" id="player-count" min="2" max="20" value="4">
                </div>
                
                <div class="form-group">
                    <label for="turn-count"><i class="fas fa-redo"></i> ターン数（1〜10ターン）</label>
                    <input type="number" id="turn-count" min="1" max="10" value="1">
                    <small style="display: block; margin-top: 0.5rem; color: var(--text-light);">
                        ※ 各プレイヤーが指定したターン数だけ回答します
                    </small>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-signal"></i> 難易度を選択</label>
                    <div class="difficulty-buttons">
                        <button class="difficulty-btn easy selected" data-difficulty="easy" onclick="selectDifficulty('easy')">
                            <i class="fas fa-seedling"></i> Easy<br>
                            <small>2つの単語 (×1.0)</small>
                        </button>
                        <button class="difficulty-btn hard" data-difficulty="hard" onclick="selectDifficulty('hard')">
                            <i class="fas fa-fire"></i> Hard<br>
                            <small>3つの単語 (×1.5)</small>
                        </button>
                        <button class="difficulty-btn expert" data-difficulty="expert" onclick="selectDifficulty('expert')">
                            <i class="fas fa-crown"></i> Expert<br>
                            <small>4つの単語 (×2.0)</small>
                        </button>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="showPlayerNameSetup()">
                    <i class="fas fa-arrow-right"></i> 次へ（プレイヤー名設定）
                </button>
            </div>
        </div>

        <!-- プレイヤー名設定画面 -->
        <div id="player-name-setup" class="screen">
            <h1><i class="fas fa-user-edit"></i> プレイヤー名設定</h1>
            
            <div class="game-setup">
                <p style="text-align: center; color: var(--text-light); margin-bottom: 2rem;">
                    各プレイヤーの名前を入力してください（空欄の場合はプレイヤー1、プレイヤー2...となります）
                </p>
                
                <div id="player-name-inputs" style="display: grid; gap: 1rem;">
                    <!-- JavaScriptで動的に生成 -->
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button class="btn-secondary" style="flex: 1;" onclick="showScreen('game-setup')">
                        <i class="fas fa-arrow-left"></i> 戻る
                    </button>
                    <button class="btn-primary" style="flex: 2;" onclick="startGame()">
                        <i class="fas fa-play"></i> ゲームを開始
                    </button>
                </div>
            </div>
        </div>

        <!-- ゲームプレイ画面 -->
        <div id="game-play" class="screen">
            <div class="game-header">
                <h2 style="color: white; border: none; padding: 0; margin: 0; margin-bottom: 1rem;">
                    <i class="fas fa-user"></i> <span id="current-player-name">プレイヤー1</span>の番です
                </h2>
                <div class="game-info">
                    <div class="info-item">
                        <span class="info-label">ターン</span>
                        <span class="info-value"><span id="current-turn">1</span> / <span id="total-turns">1</span></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">ラウンド</span>
                        <span class="info-value"><span id="current-round">1</span> / <span id="total-rounds">4</span></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">難易度</span>
                        <span class="info-value" id="game-difficulty">Easy</span>
                    </div>
                </div>
            </div>
            
            <div class="word-display">
                <h3 style="color: white; margin-bottom: 2rem;">これらの単語の共通点（抽象）を考えてください</h3>
                <div class="words" id="word-container"></div>
            </div>
            
            <div class="answer-section" id="answer-section">
                <h3><i class="fas fa-pen"></i> 回答を入力</h3>
                <input type="text" class="answer-input" id="answer-input" placeholder="共通点を入力してください（例：執着）">
                <button class="btn-primary" onclick="submitAnswer()">
                    <i class="fas fa-check"></i> 回答を提出
                </button>
            </div>
            
            <div class="rating-section hidden" id="rating-section">
                <h3><i class="fas fa-star"></i> <span id="rating-player-name"></span>の回答を評価してください</h3>
                <p style="font-size: 1.2rem; margin: 1rem 0;"><strong>回答：</strong><span id="submitted-answer" style="color: var(--primary-blue); font-weight: 600;"></span></p>
                <div class="stars" id="star-rating"></div>
                <button class="btn-primary" onclick="submitRating()">
                    <i class="fas fa-check"></i> 評価を提出
                </button>
            </div>
            
            <div class="scoreboard">
                <h3><i class="fas fa-list-ol"></i> スコアボード</h3>
                <div id="scoreboard-container"></div>
            </div>
        </div>

        <!-- ゲーム終了画面 -->
        <div id="game-end" class="screen">
            <h1><i class="fas fa-trophy"></i> ゲーム終了！</h1>
            
            <div class="scoreboard">
                <h2>最終スコア</h2>
                <div id="final-scoreboard"></div>
            </div>
            
            <div style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
                <button class="btn-primary" style="flex: 1; min-width: 200px;" onclick="showScreen('game-setup')">
                    <i class="fas fa-redo"></i> もう一度プレイ
                </button>
                <button class="btn-secondary" style="flex: 1; min-width: 200px;" onclick="showScreen('home')">
                    <i class="fas fa-home"></i> ホームに戻る
                </button>
            </div>
        </div>

        <!-- ブレインストーミング画面 -->
        <div id="brainstorm" class="screen">
            <h1><i class="fas fa-lightbulb"></i> ブレインストーミング</h1>
            
            <div class="brainstorm-controls">
                <input type="text" class="theme-input" id="theme-input" placeholder="テーマを入力...">
                <button class="btn-add" onclick="addStickyNote('concrete')">
                    <i class="fas fa-plus"></i> 具体を追加
                </button>
                <button class="btn-add" onclick="addStickyNote('abstract')">
                    <i class="fas fa-plus"></i> 抽象を追加
                </button>
                <button class="btn-save" onclick="saveBrainstorm()">
                    <i class="fas fa-save"></i> 保存
                </button>
                <button class="btn-load" onclick="loadBrainstorm()">
                    <i class="fas fa-folder-open"></i> 読込
                </button>
                <button class="btn-clear" onclick="clearBrainstorm()">
                    <i class="fas fa-trash"></i> クリア
                </button>
            </div>
            
            <div class="canvas-area" id="canvas-area">
                <p style="text-align: center; color: var(--text-light); margin-top: 10rem;">
                    付箋を追加してアイデアを整理しましょう！<br>
                    ドラッグ&ドロップで自由に配置できます。
                </p>
            </div>
        </div>

        <!-- 解説画面 -->
        <div id="explanation" class="screen">
            <h1><i class="fas fa-book"></i> 具体⇄抽象の解説</h1>
            
            <div class="explanation-content">
                <h2>1. なぜ具体⇄抽象が重要なのか？</h2>
                <p>
                    仕事・プライベートで会話が伝わらない。そんなことありますよね。「君の話していることがわからない」「何が言いたいの」。
                    アイデア出ししても「それは違う」などと言われたことはないでしょうか？
                </p>
                <p>
                    <strong>実はそれは具体⇄抽象の往復に問題があるんです！</strong>
                </p>
                <p>
                    具体⇄抽象の往復ができるだけで、斬新なアイデア・AI時代にも残れる会話力・説明力が上がるなどができるようになります。
                </p>
                
                <div class="example-box">
                    <h4><i class="fas fa-lightbulb"></i> 成果は「具体⇄抽象の往復」で最大化</h4>
                    <p>
                        成果を出す人は、細部に溺れず、しかし本質だけで終わらせない。<br>
                        <strong>抽象（法則化）→ 具体（実装・数値化）→ 抽象（学びの再整理）</strong>の往復がカギです。
                    </p>
                </div>

                <h2>2. 具体と抽象とは？</h2>
                <p>
                    <strong>具体</strong>＝細かく特定できる・目に見える・自由度が低い<br>
                    <strong>抽象</strong>＝共通点や法則でまとめる・本質的・自由度が高い
                </p>
                
                <div class="hierarchy-diagram">
                    生物（抽象）→ 動物 → 哺乳類 → 人間 → 日本人（具体）
                </div>
                <p class="text-center">右に行くほど具体的です</p>
                
                <div class="example-box">
                    <h4>例2：エネルギーの分類</h4>
                    <p>エネルギー（抽象）→ 位置・運動・電気・化学（具体）</p>
                    <p>具体的になればなるほど個々になり、情報が豊富になります。</p>
                </div>

                <h2>3. 会話での使い分け</h2>
                <p>
                    <strong>新人や経験が乏しい人には具体的に、ベテランや慣れている人には抽象的に。</strong>
                </p>
                
                <div class="example-box">
                    <h4>例：中華を食べたい場合</h4>
                    <p>
                        「中華食べたい」→ 相手はラーメン、餃子、麻婆豆腐など自由に選べる（抽象的）<br>
                        「ラーメン食べたい」→ ラーメンの中から相手は選ぶ（具体的）
                    </p>
                </div>
                
                <div class="example-box">
                    <h4>仕事での説明の違い</h4>
                    <p>
                        <strong>新入社員：</strong>「Aという資料は資料室の左の棚の上から2番目に置いてね」<br>
                        → 新人はわからないので細かく具体的に説明する
                    </p>
                    <p>
                        <strong>ベテラン：</strong>「ここにあるもの整理整頓お願いします」<br>
                        → ある程度わかるので抽象的に説明して無駄を省く
                    </p>
                </div>
                
                <div class="example-box" style="border-left-color: var(--expert-red);">
                    <h4><i class="fas fa-exclamation-triangle"></i> もし具体と抽象が反転したら？</h4>
                    <p>
                        <strong>新人に：</strong>「歓迎会の幹事をお願いね」<br>
                        → お店、どこにするか、費用、時間はなどがわからない！
                    </p>
                    <p>
                        <strong>ベテランに：</strong>「Aというお店で、〇〇日、2時間ぐらいのお店を予約して」<br>
                        → もっと知っているお店あるのに...と思ってしまう
                    </p>
                    <p><strong>このようなトラブルが発生します。よって具体⇄抽象の行き来が重要です！</strong></p>
                </div>

                <h2>4. 問題解決での活用</h2>
                <p>
                    <strong>できないのは才能ではなく"分解の粒度"</strong><br>
                    原因 → 要因 → 対策に分けると"できる設計"になります。
                </p>
                
                <div class="example-box">
                    <h4>例：「勉強が苦手」を分解</h4>
                    <p>
                        <strong>勉強が苦手</strong>＝ 暗記 / 計算 / じっとする の何が難しい？<br>
                        具体⇄抽象を行き来して要因を特定します。
                    </p>
                    <ul>
                        <li><strong>暗記：</strong>量が多い / 覚え方がない / 復習間隔ゼロ</li>
                        <li><strong>計算：</strong>手順が曖昧 / 型がない / 検算法がない</li>
                        <li><strong>じっとする：</strong>環境ノイズ / 姿勢・光量 / ご褒美不足</li>
                    </ul>
                </div>
                
                <div class="example-box">
                    <h4>次に具体的に落とし込む（数値化）</h4>
                    <p>
                        <strong>原因：</strong>復習間隔がランダム<br>
                        <strong>要因：</strong>寝る前に復習していない<br>
                        <strong>対策（具体）：</strong>自習室で19:00〜19:30に"昨日の10問"だけ暗記
                    </p>
                </div>

                <h2>5. 説明下手の解消方法</h2>
                <p>
                    <strong>相手が知っている言葉で言い切る</strong>（専門語 → 日常語・その人の知っている知識）
                </p>
                
                <div class="example-box">
                    <h4>例1：3歳の子供への仕事説明</h4>
                    <p>
                        SEとしてプログラマーをしている場合：<br>
                        プログラム（具体）→ 操作するための指示すること（抽象）→ 
                        <strong>「ママ・パパはね、機械とのお話しする仕事してるのよ」</strong>（相手の理解できる用語で具体的に）
                    </p>
                </div>
                
                <div class="example-box">
                    <h4>例2：専門用語（HSAB則）の説明</h4>
                    <p>
                        専門的：「硬い酸は硬い塩基、柔らかい酸は柔らかい塩基と好んで結合してより安定になる」<br>
                        → ほとんどの人は理解できない...
                    </p>
                    <p>
                        日常語に変換：<strong>「アニメオタク+アニメオタク、野球好き+野球好きで群れる。つまり、同じ者同士で群れることですね。
                        アニメオタク+野球好きの組み合わせは、話が噛み合わなくて一緒にいないですよね。」</strong>
                    </p>
                    <p>→ 抽象化して共通点から日常用語に変換することで専門用語もわかりやすくなります！</p>
                </div>

                <h2>6. 仕事で起きがちな「具体病」と「抽象病」</h2>
                
                <div class="example-box" style="border-left-color: var(--expert-red);">
                    <h4><i class="fas fa-bug"></i> 具体病</h4>
                    <p>
                        「携帯を安くして」に対し、値段だけ下げる。<br>
                        → 問題の本質を掴めていないので、別の問題が発生してしまう。<br>
                        <strong>本質＝総コスト（時間・手間・故障）を下げること</strong>
                    </p>
                </div>
                
                <div class="example-box" style="border-left-color: var(--hard-yellow);">
                    <h4><i class="fas fa-bug"></i> 抽象病</h4>
                    <p>
                        「頑張ります」「徹底強化」...何をいつどうするか不明。<br>
                        → 抽象的で具体に落とし込めていないので問題の先送りとなる。<br>
                        <strong>置き換え＝「来週金曜までに12%コスト削減。内訳：通信6%、端末3%、工数3%」</strong>
                    </p>
                </div>
                
                <p>
                    <strong>自分の課題は具体的に、他人の議論は抽象で捉える</strong><br>
                    例：炎上例の「○○人は〜」は抽象の乱用。経理部の人は〇〇だよねぇ〜。など炎上の原因となります。<br>
                    具体的データと文脈に戻して考えましょう。
                </p>

                <h2>7. 学びを加速する「抽象→具体 / 具体→抽象」ドリル</h2>
                
                <ul class="training-list">
                    <li>
                        <strong>A. 抽象→具体（得意になりやすい）</strong><br>
                        具体化トレーニング①：<strong>How（どうやって）</strong>と問いかける。
                    </li>
                    <li>
                        <strong>B. 具体→抽象（多くの人が苦手）</strong><br>
                        抽象化トレーニング①：<strong>Why（なぜ）</strong>と問いかける。
                    </li>
                    <li>
                        <strong>抽象化トレーニング②：</strong>新しい知識・経験を増やす。<br>
                        → オススメは読書、海外旅行、新しいことへの挑戦、別分野の人との交流、副業。
                    </li>
                    <li>
                        <strong>抽象化トレーニング③：</strong>真反対・無関係なことを同じ抽象にまとめる<br>
                        <div style="margin-top: 0.5rem; padding-left: 1rem;">
                            ・成功と失敗 → <strong>行動の結果</strong><br>
                            ・愛情と憎しみ → <strong>対象への強い注意（執着）</strong><br>
                            ・資産5億 vs 借金5億 → <strong>大きなキャッシュフローを動かす力</strong>
                        </div>
                    </li>
                    <li>
                        <strong>抽象化トレーニング④：</strong>学んだ内容をXで投稿！<br>
                        <div style="margin-top: 0.5rem; padding-left: 1rem; background: rgba(29, 161, 242, 0.1); padding: 1rem; border-radius: 8px;">
                            <i class="fab fa-x-twitter"></i> 文字数制限があるXでの投稿は、自然と要点を絞り込む必要があり、抽象化の良いトレーニングになります。<br>
                            学んだことを<strong>140〜280文字でまとめる練習</strong>をしましょう。
                        </div>
                    </li>
                </ul>

                <h2>8. 「0円化」を見抜く抽象フレーム</h2>
                <p>
                    <strong>テクノロジー × ボトルネック</strong>
                </p>
                <div class="example-box">
                    <h4>例：写真の0円化</h4>
                    <p>
                        写真はカメラ機能の小型化＋通信の高速化で費用がほぼ0になった。<br>
                        技術革新により0円となった（抽象化）。他の分野では？と考えてみましょう。
                    </p>
                    <ul>
                        <li><strong>AIで"認知の下請け"が0円化：</strong>議事録・要約・初稿生成</li>
                        <li><strong>自動運転の普及で"移動時間の付加価値化"：</strong>車＝動く個室（半・不動産化）の可能性</li>
                        <li><strong>新入社員の単純作業はAI×テンプレ化でスリム化</strong></li>
                    </ul>
                    <p>
                        → 抽象＝「高頻度・反復・判断ルールが明確」な作業は、0円に近づく<br>
                        → 具体＝"人にしかできない"探索・共感・交渉・設計にシフト
                    </p>
                </div>

                <h2>9. 今すぐ使える「具体⇄抽象」チェックリスト</h2>
                
                <div class="checklist">
                    <h3><i class="fas fa-clipboard-check"></i> チェックリスト</h3>
                    <ul>
                        <li><i class="fas fa-check-circle"></i> <strong>目的を1行で（抽象）：</strong>_______________</li>
                        <li><i class="fas fa-check-circle"></i> <strong>数値指標を3つ（具体）：</strong>_______________</li>
                        <li><i class="fas fa-check-circle"></i> <strong>行うことは？（具体）：</strong>_______________</li>
                    </ul>
                </div>

                <h2>10. まとめ</h2>
                <div class="example-box">
                    <p>
                        <strong>具体＝行動、抽象＝法則。両方を行き来してはじめて成果が出る。</strong>
                    </p>
                    <p>
                        <strong>トレーニング：</strong>新しい知識・経験の習得、How・Whyを問いかける。まとめる。学んだことをXに投稿。
                    </p>
                    <p>
                        <strong>次の5分で、「目的1行」「指標3つ」「初動5分」を書こう。</strong>
                    </p>
                </div>
                
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--bg-light); border-radius: 10px;">
                    <h4>参考文献</h4>
                    <ul>
                        <li>『具体と抽象 世界が変わって見える知性の仕組み』細谷 功</li>
                        <li>『「具体⇄抽象」トレーニング 思考力がアップする29問』細谷 功</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== グローバル変数 =====
        let currentScreen = 'home';
        let gameState = {
            playerCount: 4,
            turnCount: 1,
            difficulty: 'easy',
            currentPlayer: 0,
            currentRound: 0,
            currentTurn: 1,
            totalRounds: 0,
            players: [],
            currentWords: [],
            currentAnswer: '',
            ratings: [],
            ratingCount: 0
        };
        
        // ===== 単語データベース（1,300語以上） =====
        const wordDatabase = {
            emotions: [
                '愛', '憎しみ', '喜び', '悲しみ', '怒り', '恐怖', '驚き', '嫌悪', '期待', '失望',
                '安心', '不安', '希望', '絶望', '幸福', '不幸', '満足', '不満', '感謝', '後悔',
                '嫉妬', '羨望', '憧れ', '尊敬', '軽蔑', '同情', '共感', '孤独', '寂しさ', '懐かしさ',
                '切なさ', '苛立ち', '焦り', '緊張', '興奮', '高揚', '達成感', '充実感', '虚無感', '罪悪感',
                '劣等感', '優越感', '恥', '誇り', '屈辱', '復讐心', '慈悲', '憤怒', '嫌気', '退屈',
                '好奇心', '無関心', '熱意', '冷淡', '歓喜', '憂鬱', '落胆', '困惑', '動揺', '平静',
                '驚愕', '恐慌', '安堵', '焦燥', '倦怠', '無気力', '意欲', '執念', '諦念', '決意',
                '迷い', '葛藤', '覚悟', '執着', '解放', '束縛', '自由', '依存', '自立', '信頼',
                '疑念', '確信', '動揺', '冷静', 'パニック', 'リラックス', 'ストレス', 'プレッシャー', '安らぎ', '苦悩',
                '歓喜', '哀愁', '郷愁', '恋慕', '失恋', '片思い', '両思い', '愛憎', '友愛', '博愛'
            ],
            nature: [
                '太陽', '月', '星', '惑星', '銀河', '彗星', '流星', '日食', '月食', 'オーロラ',
                '山', '谷', '川', '海', '湖', '池', '滝', '崖', '洞窟', '平原',
                '砂漠', '森', '林', '丘', '島', '半島', '岬', '湾', '入江', '港',
                '雨', '雪', '風', '雷', '霧', '霜', '雹', '台風', '竜巻', '虹',
                '雲', '晴れ', '曇り', '嵐', '吹雪', '雷雨', '雨雲', '積雲', '層雲', '巻雲',
                '春', '夏', '秋', '冬', '梅雨', '初夏', '晩秋', '初冬', '立春', '立夏',
                '立秋', '立冬', '春分', '夏至', '秋分', '冬至', '朝', '昼', '夕方', '夜',
                '明け方', '夕暮れ', '真夜中', '日の出', '日の入り', '朝焼け', '夕焼け', '黄昏', '薄明', '満月',
                '新月', '半月', '三日月', '十五夜', '火', '水', '土', '木', '金', '石',
                '岩', '砂', '泥', '氷', '蒸気', '露', '霧氷', '樹氷', '氷柱', '雪解け'
            ],
            society: [
                '赤ちゃん', '子供', '少年', '少女', '青年', '大人', '老人', '男性', '女性', '父',
                '母', '兄', '弟', '姉', '妹', '祖父', '祖母', '親', '子', '孫',
                '夫', '妻', '恋人', '友人', '知人', '他人', '先生', '生徒', '上司', '部下',
                '同僚', '先輩', '後輩', 'ライバル', '仲間', '敵', '味方', '家族', '親族', '他人',
                '医者', '看護師', '教師', '弁護士', '警察官', '消防士', 'パイロット', '運転手', '料理人', '美容師',
                'デザイナー', 'エンジニア', 'プログラマー', '営業', '事務員', '農家', '漁師', '大工', '電気工', '配達員',
                '法律', '規則', 'ルール', 'マナー', '倫理', '道徳', '正義', '平等', '自由', '権利',
                '義務', '責任', '契約', '約束', '信頼', '裏切り', '誠実', '不正', '公正', '偏見',
                '会社', '学校', '病院', '政府', '国', '県', '市', '町', '村', '団体',
                'チーム', 'グループ', '組織', '集団', '個人', '友情', '愛情', '対立', '協力', '競争'
            ],
            abstract: [
                '過去', '現在', '未来', '永遠', '瞬間', '一瞬', '長期', '短期', '始まり', '終わり',
                '継続', '変化', '成長', '衰退', '循環', 'リズム', 'タイミング', '機会', '運命', '偶然',
                '必然', '原因', '結果', '影響', '効果', '意味', '価値', '目的', '手段', '方法',
                '上', '下', '左', '右', '前', '後', '内', '外', '中心', '周辺',
                '近い', '遠い', '広い', '狭い', '高い', '低い', '深い', '浅い', '表', '裏',
                '多い', '少ない', '大きい', '小さい', '長い', '短い', '重い', '軽い', '厚い', '薄い',
                '太い', '細い', '増加', '減少', '倍', '半分', '全部', '一部', '全体', '部分',
                '美', '醜', '善', '悪', '真', '偽', '強', '弱', '硬', '柔',
                '明', '暗', '温', '冷', '速', '遅', '新', '古', '清', '濁',
                '静止', '運動', '安定', '不安定', '平衡', '不均衡', '秩序', '混沌', '単純', '複雑'
            ],
            objects: [
                '水', '火', '土', '風', '金', '銀', '銅', '鉄', '炭素', '酸素',
                '窒素', '水素', '木材', '石材', '金属', 'ガラス', 'プラスチック', '紙', '布', '革',
                'ゴム', 'セラミック', '家', 'ビル', '橋', '塔', '城', '神社', '寺', '教会',
                '駅', '空港', '港', '道路', 'トンネル', 'ダム', 'ハンマー', 'ドライバー', 'のこぎり', 'はさみ',
                'ナイフ', 'フォーク', 'スプーン', '箸', 'ペン', '鉛筆', '消しゴム', '定規', 'ノート', '本',
                '車', '電車', '飛行機', '船', '自転車', 'バイク', 'エレベーター', 'エスカレーター', '時計', 'カメラ',
                '電話', 'パソコン', 'テレビ', '冷蔵庫', '洗濯機', '机', '椅子', 'ベッド', '棚', 'タンス',
                'ソファ', 'テーブル', '照明', 'カーテン', 'カーペット', 'ドア', '窓', '壁', '床', '天井',
                '屋根', '柱', '階段', '玄関', 'リビング', '寝室', '台所', '風呂', 'トイレ', '庭',
                'ベランダ', 'ガレージ', '倉庫', '小屋', 'テント', '傘', '帽子', '靴', '靴下', '手袋'
            ],
            culture: [
                '絵画', '彫刻', '音楽', 'ダンス', '演劇', '映画', '写真', '文学', '詩', '小説',
                '漫画', 'アニメ', 'ゲーム', 'メロディ', 'リズム', 'ハーモニー', 'テンポ', '音色', '音量', '高音',
                '低音', '和音', '不協和音', 'ギター', 'ピアノ', 'ドラム', 'バイオリン', 'フルート', 'トランペット', 'サックス',
                '赤', '青', '黄', '緑', '紫', '橙', '桃', '白', '黒', '灰',
                '金', '銀', '虹色', 'パステル', 'ビビッド', '丸', '四角', '三角', '楕円', '星形',
                'ハート', '十字', '渦巻', '波', '直線', '曲線', '角', '点', '面', '立体',
                '平面', '空間', '遠近', '陰影', '光', '影', '明暗', '濃淡', 'グラデーション', 'コントラスト',
                '彩度', '明度', '色相', '補色', '類似色', '寒色', '暖色', '中性色', 'モノトーン', 'カラフル',
                '和', '洋', '中', '伝統', '近代', '現代', '古典', '前衛', '保守', '革新',
                '流行', '定番', '普遍', '一時的', '永続的', '栄枯', '盛衰', '興亡', '繁栄', '衰退'
            ],
            knowledge: [
                '物理', '化学', '生物', '地学', '数学', '統計', '実験', '観察', '仮説', '理論',
                '法則', '原理', '定理', '公式', '方程式', '関数', '変数', '定数', '係数', '指数',
                '対数', '微分', '積分', 'ベクトル', '行列', '集合', '確率', '推定', '検定', '相関',
                '因果', '発明', '開発', '設計', '製造', '改良', '革新', '伝統', '進化', '最適化',
                '効率', '生産性', '品質', '精度', '正確', '誤差', '論理', '直感', '分析', '総合',
                '帰納', '演繹', '創造', '模倣', '応用', '基礎', '理論', '実践', '知識', '経験',
                '学習', '記憶', '理解', '思考', '判断', '推論', '洞察', '認識', '知覚', '感覚',
                '視覚', '聴覚', '触覚', '味覚', '嗅覚', '第六感', '直感', '予感', '予知', '予測',
                '計画', '実行', '評価', '改善', 'PDCAサイクル', '目標', '手段', '戦略', '戦術', '方針',
                'ビジョン', 'ミッション', 'バリュー', '理念', '哲学', '思想', '信念', '価値観', '世界観', '人生観'
            ],
            economy: [
                'お金', '富', '貧困', '価値', '価格', '費用', '利益', '損失', '投資', '貯蓄',
                '借金', '返済', '利子', '利息', '元本', '資本', '資産', '負債', '純資産', '現金',
                '預金', '株', '債券', '不動産', '売買', '交換', '贈与', '購入', '販売', '輸出',
                '輸入', '供給', '需要', '競争', '独占', '寡占', '市場', '経済', '景気', '不況',
                '好況', 'バブル', '恐慌', 'インフレ', 'デフレ', '物価', '賃金', '給料', '報酬', 'ボーナス',
                '昇給', '減給', '失業', '就職', '転職', '起業', '倒産', '破産', '再生', '成長',
                '計画', '実行', '評価', '改善', '戦略', '戦術', '目標', '手段', 'リスク', '機会',
                '脅威', '強み', '弱み', 'SWOT', 'マーケティング', 'ブランディング', 'プロモーション', '広告', 'PR', 'セールス',
                '交渉', '契約', '提携', '合併', '買収', 'M&A', '株主', '経営者', '従業員', '顧客',
                '取引先', '競合', 'パートナー', 'ステークホルダー', 'イノベーション', '創造', '破壊', '変革', '改革', '維持'
            ],
            daily: [
                '朝食', '昼食', '夕食', '間食', '食材', '調味料', '料理', '飲み物', 'デザート', '和食',
                '洋食', '中華', 'イタリアン', 'フレンチ', 'ラーメン', '寿司', '天ぷら', '焼肉', '鍋', 'カレー',
                'シャツ', 'ズボン', 'スカート', 'ドレス', 'コート', '帽子', '靴', '靴下', '手袋', 'マフラー',
                'ネクタイ', 'ベルト', '鞄', 'リュック', '財布', '時計', 'アクセサリー', 'メガネ', 'サングラス', 'マスク',
                '玄関', 'リビング', '寝室', '台所', '風呂', 'トイレ', '庭', 'ベランダ', '屋根', '壁',
                '床', '窓', 'ドア', '天井', '階段', '廊下', '収納', 'クローゼット', '押入れ', '物置',
                '歩く', '走る', '跳ぶ', '座る', '立つ', '寝る', '食べる', '飲む', '見る', '聞く',
                '話す', '考える', '笑う', '泣く', '怒る', '喜ぶ', '悲しむ', '驚く', '楽しむ', '苦しむ',
                '働く', '遊ぶ', '学ぶ', '休む', '寝る', '起きる', '出かける', '帰る', '買う', '売る',
                '作る', '壊す', '直す', '掃除', '洗濯', '料理', '勉強', '運動', '趣味', '娯楽'
            ],
            animals: [
                '犬', '猫', '鳥', '魚', '虫', '馬', '牛', '豚', '鶏', '羊',
                'ライオン', '象', 'キリン', 'シマウマ', 'サル', 'クマ', 'ウサギ', 'ネズミ', 'ヘビ', 'カエル',
                'カメ', 'イルカ', 'クジラ', 'サメ', 'タコ', 'イカ', 'エビ', 'カニ', '蝶', '蜂',
                'アリ', 'クモ', 'トンボ', 'セミ', 'バッタ', 'カブトムシ', 'クワガタ', 'コウロギ', 'カマキリ', 'テントウムシ',
                '木', '花', '草', '苔', '藻', '樹', '葉', '根', '枝', '幹',
                '種', '実', '桜', '梅', '松', '竹', '薔薇', '菊', '百合', '向日葵',
                'チューリップ', 'タンポポ', 'スミレ', 'コスモス', 'アジサイ', 'ツツジ', 'サツキ', 'カーネーション', 'ユリ', 'ラン',
                'サボテン', 'シダ', 'コケ', '稲', '麦', 'トウモロコシ', 'ジャガイモ', 'サツマイモ', 'ニンジン', '大根',
                'キャベツ', 'レタス', 'トマト', 'キュウリ', 'ナス', 'ピーマン', '玉ねぎ', 'ネギ', 'ニンニク', '生姜',
                'リンゴ', 'ミカン', 'バナナ', 'ブドウ', 'イチゴ', 'メロン', 'スイカ', '桃', '梨', '柿',
                '鷹', '鷲', '鳩', '雀', '烏', '白鳥', '鶴', '孔雀', 'フクロウ', 'ペンギン',
                'ダチョウ', 'フラミンゴ', 'オウム', 'インコ', 'カナリア', 'ツバメ', 'カモメ', 'ペリカン', 'アヒル', 'ガチョウ',
                '鯛', '鮭', 'マグロ', 'カツオ', 'サバ', 'イワシ', 'アジ', 'サンマ', '鰻', 'ナマズ',
                '鯉', '金魚', 'メダカ', 'フグ', 'エイ', 'ウミウシ', 'ヒトデ', 'クラゲ', 'サンゴ', '貝',
                'アサリ', 'ハマグリ', 'ホタテ', 'カキ', 'サザエ', 'アワビ', 'ウニ', 'ナマコ', 'シャコ', 'ロブスター',
                'トラ', '豹', 'チーター', 'ジャガー', 'ハイエナ', 'オオカミ', 'キツネ', 'タヌキ', 'イタチ', 'カワウソ',
                'アザラシ', 'セイウチ', 'ラッコ', 'ビーバー', 'リス', 'ハムスター', 'モルモット', 'ウサギ', 'ネズミ', 'コウモリ',
                'カンガルー', 'コアラ', 'パンダ', 'ゴリラ', 'チンパンジー', 'オランウータン', 'テナガザル', 'ヒヒ', 'マンドリル', 'キツネザル',
                'ナマケモノ', 'アルマジロ', 'アリクイ', 'カピバラ', 'ヤマアラシ', 'ハリネズミ', 'モグラ', 'トガリネズミ', 'ハツカネズミ', 'ドブネズミ',
                'カバ', 'サイ', 'バク', '鹿', 'ヘラジカ', 'トナカイ', 'カモシカ', 'ヤギ', 'イノシシ', 'ラクダ'
            ],
            actions: [
                '見る', '聞く', '話す', '考える', '感じる', '触る', '嗅ぐ', '味わう', '動く', '止まる',
                '進む', '戻る', '上がる', '下がる', '入る', '出る', '開く', '閉じる', '始める', '終わる',
                '作る', '壊す', '直す', '変える', '保つ', '与える', '受ける', '取る', '置く', '持つ',
                '運ぶ', '投げる', '捕る', '押す', '引く', '叩く', '撫でる', '掴む', '放す', '握る',
                '書く', '読む', '描く', '消す', '切る', '貼る', '折る', '曲げる', '伸ばす', '縮める',
                '増やす', '減らす', '集める', '散らす', '並べる', '混ぜる', '分ける', '合わせる', '選ぶ', '捨てる',
                '探す', '見つける', '隠す', '現れる', '消える', '来る', '行く', '残る', '去る', '待つ',
                '急ぐ', '遅れる', '追う', '逃げる', '戦う', '守る', '攻める', '勝つ', '負ける', '競う',
                '協力する', '助ける', '邪魔する', '応援する', '励ます', '叱る', '褒める', '教える', '学ぶ', '覚える',
                '忘れる', '思い出す', '想像する', '計画する', '実行する', '評価する', '反省する', '改善する', '挑戦する', '諦める'
            ],
            states: [
                '生', '死', '誕生', '成長', '成熟', '老化', '再生', '腐敗', '新鮮', '古い',
                '若い', '年寄り', '元気', '病気', '健康', '不健康', '強い', '弱い', '大きい', '小さい',
                '太い', '細い', '高い', '低い', '長い', '短い', '広い', '狭い', '深い', '浅い',
                '重い', '軽い', '硬い', '柔らかい', '熱い', '冷たい', '温かい', 'ぬるい', '明るい', '暗い',
                '清潔', '不潔', '綺麗', '汚い', '整然', '乱雑', '静か', '騒がしい', '平和', '混乱',
                '安全', '危険', '安定', '不安定', '確実', '不確実', '正確', '不正確', '完全', '不完全',
                '満足', '不満', '充実', '空虚', '豊か', '貧しい', '裕福', '貧困', '成功', '失敗',
                '勝利', '敗北', '優勝', '最下位', '一位', '最後', '最高', '最低', '最大', '最小',
                '開始', '終了', '継続', '中断', '再開', '中止', '延期', '早める', '遅らせる', '同時',
                '順番', '交代', '並行', '連続', '断続', '周期', '不規則', '規則的', 'ランダム', 'パターン'
            ]
        };
        
        // ===== 画面切り替え =====
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            currentScreen = screenId;
            
            if (screenId === 'home') {
                displayHighScores();
            }
        }
        
        // ===== 難易度選択 =====
        function selectDifficulty(difficulty) {
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.difficulty-btn').classList.add('selected');
            gameState.difficulty = difficulty;
        }
        
        // ===== プレイヤー名設定画面を表示 =====
        function showPlayerNameSetup() {
            const playerCount = parseInt(document.getElementById('player-count').value);
            const turnCount = parseInt(document.getElementById('turn-count').value);
            
            if (playerCount < 2 || playerCount > 20) {
                alert('参加人数は2〜20人で設定してください');
                return;
            }
            
            if (turnCount < 1 || turnCount > 10) {
                alert('ターン数は1〜10で設定してください');
                return;
            }
            
            // プレイヤー名入力欄を生成
            const container = document.getElementById('player-name-inputs');
            container.innerHTML = '';
            
            for (let i = 0; i < playerCount; i++) {
                const inputGroup = document.createElement('div');
                inputGroup.className = 'form-group';
                inputGroup.innerHTML = `
                    <label for="player-name-${i}"><i class="fas fa-user"></i> プレイヤー${i + 1}の名前</label>
                    <input type="text" id="player-name-${i}" class="answer-input" placeholder="例：太郎、花子、Aさん など" maxlength="20">
                `;
                container.appendChild(inputGroup);
            }
            
            showScreen('player-name-setup');
        }
        
        // ===== ランダムな単語を取得 =====
        function getRandomWords(count) {
            const allWords = [];
            Object.values(wordDatabase).forEach(category => {
                allWords.push(...category);
            });
            
            const shuffled = allWords.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }
        
        // ===== ゲーム開始 =====
        function startGame() {
            const playerCount = parseInt(document.getElementById('player-count').value);
            const turnCount = parseInt(document.getElementById('turn-count').value);
            
            // ゲーム状態を初期化
            gameState.playerCount = playerCount;
            gameState.turnCount = turnCount;
            gameState.totalRounds = playerCount * turnCount;
            gameState.currentPlayer = 0;
            gameState.currentRound = 0;
            gameState.currentTurn = 1;
            gameState.players = [];
            
            // プレイヤー名を取得
            for (let i = 0; i < playerCount; i++) {
                const nameInput = document.getElementById(`player-name-${i}`);
                const name = nameInput && nameInput.value.trim() ? nameInput.value.trim() : `プレイヤー${i + 1}`;
                gameState.players.push({
                    name: name,
                    score: 0
                });
            }
            
            // 最初のラウンドを開始
            startRound();
            showScreen('game-play');
        }
        
        // ===== ラウンド開始 =====
        function startRound() {
            gameState.currentRound++;
            gameState.ratings = [];
            gameState.ratingCount = 0;
            
            // 単語数を難易度に応じて設定
            let wordCount;
            switch (gameState.difficulty) {
                case 'easy': wordCount = 2; break;
                case 'hard': wordCount = 3; break;
                case 'expert': wordCount = 4; break;
            }
            
            gameState.currentWords = getRandomWords(wordCount);
            
            // UI更新
            document.getElementById('current-player-name').textContent = gameState.players[gameState.currentPlayer].name;
            document.getElementById('current-turn').textContent = gameState.currentTurn;
            document.getElementById('total-turns').textContent = gameState.turnCount;
            document.getElementById('current-round').textContent = gameState.currentRound;
            document.getElementById('total-rounds').textContent = gameState.totalRounds;
            document.getElementById('game-difficulty').textContent = 
                gameState.difficulty === 'easy' ? 'Easy (×1.0)' :
                gameState.difficulty === 'hard' ? 'Hard (×1.5)' : 'Expert (×2.0)';
            
            // 単語を表示
            const wordContainer = document.getElementById('word-container');
            wordContainer.innerHTML = '';
            gameState.currentWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word';
                wordDiv.textContent = word;
                wordContainer.appendChild(wordDiv);
            });
            
            // 回答セクションを表示、評価セクションを非表示
            document.getElementById('answer-section').classList.remove('hidden');
            document.getElementById('rating-section').classList.add('hidden');
            document.getElementById('answer-input').value = '';
            
            // スコアボードを更新
            updateScoreboard();
        }
        
        // ===== 回答提出 =====
        function submitAnswer() {
            const answer = document.getElementById('answer-input').value.trim();
            
            if (!answer) {
                alert('回答を入力してください');
                return;
            }
            
            gameState.currentAnswer = answer;
            
            // 回答セクションを非表示、評価セクションを表示
            document.getElementById('answer-section').classList.add('hidden');
            document.getElementById('rating-section').classList.remove('hidden');
            document.getElementById('rating-player-name').textContent = gameState.players[gameState.currentPlayer].name;
            document.getElementById('submitted-answer').textContent = answer;
            
            // 星評価を初期化
            initStarRating();
        }
        
        // ===== 星評価の初期化 =====
        function initStarRating() {
            const starContainer = document.getElementById('star-rating');
            starContainer.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('i');
                star.className = 'fas fa-star star';
                star.dataset.rating = i;
                star.onclick = function() {
                    selectStar(i);
                };
                starContainer.appendChild(star);
            }
        }
        
        // ===== 星選択 =====
        let selectedRating = 0;
        function selectStar(rating) {
            selectedRating = rating;
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }
        
        // ===== 評価提出 =====
        function submitRating() {
            if (selectedRating === 0) {
                alert('評価を選択してください');
                return;
            }
            
            gameState.ratings.push(selectedRating);
            gameState.ratingCount++;
            
            // 回答者以外全員が評価したかチェック
            if (gameState.ratingCount >= gameState.playerCount - 1) {
                // スコアを計算
                const averageRating = gameState.ratings.reduce((a, b) => a + b, 0) / gameState.ratings.length;
                
                // 難易度倍率を適用
                let multiplier = 1.0;
                switch (gameState.difficulty) {
                    case 'hard': multiplier = 1.5; break;
                    case 'expert': multiplier = 2.0; break;
                }
                
                const score = Math.round(averageRating * multiplier * 10);
                gameState.players[gameState.currentPlayer].score += score;
                
                // 次のプレイヤーへ
                gameState.currentPlayer++;
                
                // 全プレイヤーが1ターン終了したかチェック
                if (gameState.currentPlayer >= gameState.playerCount) {
                    gameState.currentPlayer = 0;
                    gameState.currentTurn++;
                    
                    // 全ターン終了したかチェック
                    if (gameState.currentTurn > gameState.turnCount) {
                        endGame();
                        return;
                    }
                }
                
                startRound();
            } else {
                // 次の評価者へ
                alert(`評価${gameState.ratingCount}/${gameState.playerCount - 1}を受け付けました`);
                selectedRating = 0;
                initStarRating();
            }
        }
        
        // ===== スコアボード更新 =====
        function updateScoreboard() {
            const container = document.getElementById('scoreboard-container');
            container.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'player-score';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'player-name';
                nameSpan.textContent = player.name;
                
                const scoreSpan = document.createElement('span');
                scoreSpan.className = 'player-points';
                scoreSpan.textContent = `${player.score}点`;
                
                playerDiv.appendChild(nameSpan);
                playerDiv.appendChild(scoreSpan);
                container.appendChild(playerDiv);
            });
        }
        
        // ===== ゲーム終了 =====
        function endGame() {
            // スコアでソート
            const sortedPlayers = [...gameState.players].sort((a, b) => b.score - a.score);
            
            // 最終スコアボードを表示
            const container = document.getElementById('final-scoreboard');
            container.innerHTML = '';
            
            sortedPlayers.forEach((player, index) => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'highscore-item';
                
                const rankSpan = document.createElement('span');
                rankSpan.className = 'rank';
                if (index === 0) rankSpan.classList.add('gold');
                else if (index === 1) rankSpan.classList.add('silver');
                else if (index === 2) rankSpan.classList.add('bronze');
                rankSpan.innerHTML = `<i class="fas fa-trophy"></i> ${index + 1}位`;
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'player-name';
                nameSpan.textContent = player.name;
                
                const scoreSpan = document.createElement('span');
                scoreSpan.className = 'player-points';
                scoreSpan.textContent = `${player.score}点`;
                
                playerDiv.appendChild(rankSpan);
                playerDiv.appendChild(nameSpan);
                playerDiv.appendChild(scoreSpan);
                container.appendChild(playerDiv);
            });
            
            // ハイスコアを保存
            saveHighScore(sortedPlayers[0]);
            
            showScreen('game-end');
        }
        
        // ===== ハイスコア保存 =====
        function saveHighScore(winner) {
            let highScores = JSON.parse(localStorage.getItem('highScores') || '[]');
            
            highScores.push({
                name: winner.name,
                score: winner.score,
                difficulty: gameState.difficulty,
                playerCount: gameState.playerCount,
                turnCount: gameState.turnCount,
                date: new Date().toLocaleDateString('ja-JP')
            });
            
            // スコア順にソート
            highScores.sort((a, b) => b.score - a.score);
            
            // 上位10件のみ保持
            highScores = highScores.slice(0, 10);
            
            localStorage.setItem('highScores', JSON.stringify(highScores));
        }
        
        // ===== ハイスコア表示 =====
        function displayHighScores() {
            const highScores = JSON.parse(localStorage.getItem('highScores') || '[]');
            const container = document.getElementById('highscore-display');
            
            if (highScores.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light);">まだハイスコアがありません</p>';
                return;
            }
            
            container.innerHTML = '';
            highScores.forEach((score, index) => {
                const scoreDiv = document.createElement('div');
                scoreDiv.className = 'highscore-item';
                
                const rankSpan = document.createElement('span');
                rankSpan.className = 'rank';
                if (index === 0) rankSpan.classList.add('gold');
                else if (index === 1) rankSpan.classList.add('silver');
                else if (index === 2) rankSpan.classList.add('bronze');
                rankSpan.textContent = `${index + 1}`;
                
                const infoDiv = document.createElement('div');
                const turnInfo = score.turnCount ? ` | ${score.turnCount}ターン` : '';
                infoDiv.innerHTML = `
                    <div><strong>${score.name}</strong></div>
                    <div style="font-size: 0.9rem; color: var(--text-light);">
                        ${score.date} | ${score.difficulty.toUpperCase()} | ${score.playerCount}人${turnInfo}
                    </div>
                `;
                
                const scoreSpan = document.createElement('span');
                scoreSpan.className = 'player-points';
                scoreSpan.textContent = `${score.score}点`;
                
                scoreDiv.appendChild(rankSpan);
                scoreDiv.appendChild(infoDiv);
                scoreDiv.appendChild(scoreSpan);
                container.appendChild(scoreDiv);
            });
        }
        
        // ===== ブレインストーミング機能 =====
        let stickyNotes = [];
        let draggedNote = null;
        let offsetX = 0;
        let offsetY = 0;
        
        function addStickyNote(type) {
            const canvas = document.getElementById('canvas-area');
            const note = document.createElement('div');
            note.className = `sticky-note ${type}`;
            note.style.left = Math.random() * (canvas.clientWidth - 220) + 'px';
            note.style.top = Math.random() * (canvas.clientHeight - 170) + 'px';
            
            const noteId = Date.now();
            note.dataset.id = noteId;
            
            note.innerHTML = `
                <div class="note-header">
                    <span class="note-tag">${type === 'concrete' ? '具体' : '抽象'}</span>
                    <button class="note-delete" onclick="deleteStickyNote(${noteId})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="note-content" contenteditable="true">
                    ここに入力...
                </div>
            `;
            
            // ドラッグ機能
            note.addEventListener('mousedown', startDrag);
            
            canvas.appendChild(note);
            stickyNotes.push({ id: noteId, type, element: note });
        }
        
        function startDrag(e) {
            if (e.target.classList.contains('note-content') || 
                e.target.classList.contains('note-delete') ||
                e.target.closest('.note-delete')) {
                return;
            }
            
            draggedNote = e.currentTarget;
            const rect = draggedNote.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            
            draggedNote.style.zIndex = 1000;
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }
        
        function drag(e) {
            if (!draggedNote) return;
            
            const canvas = document.getElementById('canvas-area');
            const canvasRect = canvas.getBoundingClientRect();
            
            let x = e.clientX - canvasRect.left - offsetX;
            let y = e.clientY - canvasRect.top - offsetY;
            
            // 境界チェック
            x = Math.max(0, Math.min(x, canvas.clientWidth - draggedNote.offsetWidth));
            y = Math.max(0, Math.min(y, canvas.clientHeight - draggedNote.offsetHeight));
            
            draggedNote.style.left = x + 'px';
            draggedNote.style.top = y + 'px';
        }
        
        function stopDrag() {
            if (draggedNote) {
                draggedNote.style.zIndex = 'auto';
                draggedNote = null;
            }
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }
        
        function deleteStickyNote(noteId) {
            const index = stickyNotes.findIndex(note => note.id === noteId);
            if (index !== -1) {
                stickyNotes[index].element.remove();
                stickyNotes.splice(index, 1);
            }
        }
        
        function saveBrainstorm() {
            const data = stickyNotes.map(note => ({
                id: note.id,
                type: note.type,
                content: note.element.querySelector('.note-content').textContent,
                left: note.element.style.left,
                top: note.element.style.top
            }));
            
            localStorage.setItem('brainstorm', JSON.stringify(data));
            alert('保存しました！');
        }
        
        function loadBrainstorm() {
            const data = JSON.parse(localStorage.getItem('brainstorm') || '[]');
            
            if (data.length === 0) {
                alert('保存されたデータがありません');
                return;
            }
            
            clearBrainstorm();
            
            const canvas = document.getElementById('canvas-area');
            data.forEach(noteData => {
                const note = document.createElement('div');
                note.className = `sticky-note ${noteData.type}`;
                note.style.left = noteData.left;
                note.style.top = noteData.top;
                note.dataset.id = noteData.id;
                
                note.innerHTML = `
                    <div class="note-header">
                        <span class="note-tag">${noteData.type === 'concrete' ? '具体' : '抽象'}</span>
                        <button class="note-delete" onclick="deleteStickyNote(${noteData.id})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="note-content" contenteditable="true">
                        ${noteData.content}
                    </div>
                `;
                
                note.addEventListener('mousedown', startDrag);
                canvas.appendChild(note);
                stickyNotes.push({ id: noteData.id, type: noteData.type, element: note });
            });
            
            alert('読み込みました！');
        }
        
        function clearBrainstorm() {
            stickyNotes.forEach(note => note.element.remove());
            stickyNotes = [];
        }
        
        // ===== 初期化 =====
        document.addEventListener('DOMContentLoaded', function() {
            displayHighScores();
        });
    </script>
</body>
</html>